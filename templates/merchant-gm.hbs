<form class="{{cssClass}}" autocomplete="off">
    <header class="sheet-header" ondragstart="return false;" ondrop="return false;">
        <div class="charname headerInput">
            <input class="input name" name="name" type="text" value="{{actor.name}}"
                   placeholder="{{localize 'Character Name'}}"/>
            <span class="label name">{{localize "Name"}}</span>
        </div>
        {{#when merchantType 'noteq' 'loot'}}
            <div class="headerInput">
                <input class="input species" name="data.details.species.value" type="text"
                       value="{{data.details.species.value}}" readonly placeholder="{{localize 'species'}}"/>
                <span class="label species">{{localize "species"}}</span>
            </div>
            <div id="field-careerlevel" class="headerInput">
                <input class="input-details" name="data.details.career.value" type="text"
                       value="{{data.details.career.value}}" placeholder="{{localize 'career'}}"/>
                <span class="label-details">{{localize "career"}}</span>
            </div>
        {{/when}}
    </header>

    <div class="general" ondragstart="return false;" ondrop="return false;">
        <img class="charimg profile" src="{{actor.img}}" title="{{actor.name}}"
            {{#when merchantType 'eq' 'loot'}}style="margin-left: calc(50% - 57px)" {{/when}} data-edit="img">

        <div class="row-section" style="width: 100%;margin-bottom: 20px">
            {{#when merchantType 'noteq' 'loot'}}
                <div class="col">
                    <div class="row-section wrap charBtns">
                        {{#each actor.data.characteristics as |ch c|}}
                            <div title="{{localize ch.label}}" class="col eight center">
                                {{localize ch.abrev}}
                            </div>
                        {{/each}}
                    </div>
                    <div class="row-section wrap charBtns">
                        {{#each actor.data.characteristics as |ch c|}}
                            <div class="ch-value col eight center" data-char="{{c}}"><a
                                    class="d20 die-{{c}}">{{ch.value}}</a>
                            </div>
                        {{/each}}
                    </div>
                    {{> systems/dsa5/templates/actors/parts/healthbar.html}} {{#if actor.schips}}
                    <div class="row-section">
                        <div class="col ten lineheight center" title="{{localize 'fatePoints'}}">
                            {{localize 'CHARAbbrev.fatePoints'}}
                        </div>
                        <div class="col eighty center" title="{{localize 'fatePoints'}}">
                            <input class="dsahidden" type="text" name="data.status.fatePoints.value" data-dtype="Number"
                                   value="{{actor.data.status.fatePoints.value}}"/> {{#each actor.schips as |item i|}}
                            <a class="schip {{item.cssClass}}" data-val="{{item.value}}"></a> {{/each}}
                        </div>
                        <div class="col ten center">
                        </div>
                    </div>
                {{/if}}
                </div>
            {{/when}}
        </div>

    </div>
    <!-- TABS -->
    <section id="tab-sections">
        <nav id="dsa5-primarytabs" class="sheet-tabs tabs" ondragstart="return false;" ondrop="return false;">
            {{#when merchantType 'noteq' 'loot'}}
                <a class="item" data-tab="skills">{{localize "skills"}}</a>
                <a class="item" data-tab="combat">{{localize "Combat"}}</a> {{#if actor.magic.hasSpells}}
                <a class="item" data-tab="magic">{{localize "Magic"}}</a> {{/if}} {{#if actor.magic.hasPrayers}}
                <a class="item" data-tab="religion">{{localize "Religion"}}</a> {{/if}}
                <a class="item" data-tab="main">{{localize "attributes"}}</a>
            {{/when}}
            <a class="item active" data-tab="inventory">Waren</a>
            {{#when merchantType 'noteq' 'loot'}}
                <a class="item" data-tab="status">{{localize "status"}}</a>
                <a class="item" data-tab="notes">{{localize "Notes"}}</a>
            {{/when}}
        </nav>

        <section class="content">
            {{#when merchantType 'noteq' 'loot'}}
                <div class="tab main save-scroll" data-tab="main">
                    {{> systems/dsa5/templates/actors/npc/npc-main.html}}
                </div>
                <div class="tab skills save-scroll" data-tab="skills">
                    {{> systems/dsa5/templates/actors/actor-talents.html}}
                </div>
                <div class="tab combat save-scroll" data-tab="combat">
                    {{> systems/dsa5/templates/actors/actor-combat.html}}
                </div>
                {{#if actor.magic.hasSpells}}
                    <div class="tab magic save-scroll" data-tab="magic">
                        {{> systems/dsa5/templates/actors/character/actor-magic.html}}
                    </div>
                {{/if}}
                {{#if actor.magic.hasPrayers}}
                    <div class="tab religion save-scroll" data-tab="religion">
                        {{> systems/dsa5/templates/actors/character/actor-religion.html}}
                    </div>
                {{/if}}
            {{/when}}
            <div class="tab inventory save-scroll" data-tab="inventory">

                <!-- own code is about to begin -->

                <div class="col-2" style="grid-template-columns: 250px auto">

                    <div class="box header">
                        <h1>HÃ¤ndler Settings</h1>
                        <div class="col-4">
                            <button><i class="fas fa-dice"></i></button>
                            <button><i class="far fa-eye"></i></button>
                            <button><i class="far fa-eye-slash"></i></button>
                            <button><i class="fas fa-lock"></i></button>
                        </div>

                        <div class="col-3">
                            <div class="borderless box">
                                <select id="general.merchantType" name="general.merchantType" class="labeled">
                                    {{#select general.merchantType}}
                                        {{#each options.MERCHANT_TYPE}}
                                            <option value="{{key}}">{{name}}</option>
                                        {{/each}}
                                    {{/select}}
                                </select>
                                <label for="general.merchantType">Typ</label>
                            </div>
                            <div class="borderless box">
                                <select id="general.quality" name="general.quality" class="labeled">
                                    {{#select general.quality}}
                                        {{#each options.QUALITY}}
                                            <option value="{{key}}">{{name}}</option>
                                        {{/each}}
                                    {{/select}}
                                </select>
                                <label for="general.quality">Q</label>
                            </div>
                            <div class="borderless box">
                                <select id="general.price" name="general.price" class="labeled">
                                    {{#select general.price}}
                                        {{#each options.PRICE}}
                                            <option value="{{key}}">{{name}}</option>
                                        {{/each}}
                                    {{/select}}
                                </select>
                                <label for="general.price">P</label>
                            </div>
                        </div>
                        {{#ifeq general.merchantType 'tavern'}}
                            <div class="inner box">
                                <input class="labeled" type="text" name="general.name" value="{{general.name}}"/>
                                <label>Name der Taverne <a class="re-roll" data-roll-type="name"><i
                                        class="fas fa-dice"></i></a></label>
                            </div>
                        {{/ifeq}}

                        {{#ifeq general.merchantType 'merchant'}}
                            <div class="inner box header">
                                <h2>Ankauf</h2>
                                <div class="col-2">
                                    <b>Bietet</b>
                                    <div>
                                        <select id="general.buys.price" name="general.buys.price">
                                            {{#select general.buys.price}}
                                                <option value="0">-kauft nichts</option>
                                                {{#each options.PRICE}}
                                                    <option value="{{key}}">{{name}}</option>
                                                {{/each}}
                                            {{/select}}
                                        </select>
                                    </div>
                                </div>
                                <div>
                                    <input id="general.buys.rarity-0" name="general.buys.rarity-0"
                                        {{checked general.buys.rarity-0}} type="checkbox"/>
                                    <label for="general.buys.rarity-0">{{display_rarity 0}}</label>
                                    <input id="general.buys.rarity-1" name="general.buys.rarity-1"
                                        {{checked general.buys.rarity-1}} type="checkbox"/>
                                    <label for="general.buys.rarity-1">{{display_rarity 1}}</label>
                                    <input id="general.buys.rarity-2" name="general.buys.rarity-2"
                                        {{checked general.buys.rarity-2}} type="checkbox"/>
                                    <label for="general.buys.rarity-2">{{display_rarity 2}}</label>
                                    <input id="general.buys.rarity-3" name="general.buys.rarity-3"
                                        {{checked general.buys.rarity-3}} type="checkbox"/>
                                    <label for="general.buys.rarity-3">{{display_rarity 3}}</label>
                                    <input id="general.buys.rarity-4" name="general.buys.rarity-4"
                                        {{checked general.buys.rarity-4}} type="checkbox"/>
                                    <label for="general.buys.rarity-4">{{display_rarity 4}}</label>
                                    <input id="general.buys.rarity-5" name="general.buys.rarity-5"
                                        {{checked general.buys.rarity-5}} type="checkbox"/>
                                    <label for="general.buys.rarity-5">{{display_rarity 5}}</label>
                                </div>
                            </div>
                        {{/ifeq}}
                    </div>

                    <div>
                        {{#each supply as |category n|}}
                            {{#with category}}
                                <div class="inner box header">
                                    <h2><a class="re-roll" data-roll-type="items-{{n}}"><i class="fas fa-dice"></i></a>
                                        {{categoryName}}</h2>
                                    <div class="top-bar"><a class="show-settings"><i class="fas fa-cogs"></i></a></div>

                                    <div class="edit-settings {{#unless ../general.edit-settings}}hidden{{/unless}}">
                                        <div class="col-2" style="grid-template-columns: 20px auto">
                                            <div><a class="delete-category" data-category-id="{{n}}"><i
                                                    class="fas fa-trash-alt"></i></a></div>
                                            <div class="inner box">
                                                <input type="text" name="categoryName" data-category-id="{{n}}"
                                                       value="{{categoryName}}"/>

                                                <div class="col-3">

                                                    <div class="borderless box">
                                                        <select id="library-{{n}}" name="library" class="labeled"
                                                                data-category-id="{{n}}">
                                                            {{#select library}}
                                                                <option></option>
                                                                {{#each ../options.LIBRARY_ITEM_TYPES}}
                                                                    <option value="{{this}}">{{this}}</option>
                                                                {{/each}}
                                                            {{/select}}
                                                        </select>
                                                        <label for="library-{{n}}">DSA Bibliothek</label>
                                                    </div>

                                                    <div class="borderless box">
                                                        <select id="library-{{n}}" name="library" class="labeled"
                                                                data-category-id="{{n}}">
                                                            {{#select library}}
                                                                <option></option>
                                                                {{#each ../options.LIBRARY_ITEM_TYPES}}
                                                                    <option value="{{this}}">{{this}}</option>
                                                                {{/each}}
                                                            {{/select}}
                                                        </select>
                                                        <label for="library-{{n}}">DSA Bibliothek</label>
                                                    </div>

                                                    <div class="borderless box">
                                                        <select id="library-{{n}}" name="library" class="labeled"
                                                                data-category-id="{{n}}">
                                                            {{#select library}}
                                                                <option></option>
                                                                {{#each ../options.LIBRARY_ITEM_TYPES}}
                                                                    <option value="{{this}}">{{this}}</option>
                                                                {{/each}}
                                                            {{/select}}
                                                        </select>
                                                        <label for="library-{{n}}">DSA Bibliothek</label>
                                                    </div>


                                                </div>

                                                {{stringify filter}}
                                                {{stringify source}}
                                            </div>
                                        </div>
                                    </div>

                                    <table>
                                        <tr>
                                            <th>Bild</th>
                                            <th>Name</th>
                                            <th>Preis</th>
                                            <th></th>
                                        </tr>
                                        {{#each current}}
                                            <tr>
                                                <td>
                                                    <img style="height: 32px" src="{{img}}"/>
                                                </td>
                                                <td>{{name}}</td>
                                                <td>{{price}}</td>
                                                <td>
                                                    <button>+</button>
                                                </td>
                                            </tr>
                                        {{/each}}
                                    </table>
                                </div>
                            {{/with}}
                        {{/each}}

                        <button class="add-category">Add Kategorie</button>
                    </div>

                    <!-- thats it with own code. everything else is (c) Ulisses and taken from the dsa5 core system -->

                </div>
            </div>

            {{#when merchantType 'noteq' 'loot'}}
                <div class="tab status save-scroll" data-tab="status">
                    status
                    {{> systems/dsa5/templates/actors/parts/status_effects.html}}
                </div>
                <div class="tab save-scroll" data-tab="notes">
                    notes
                    {{> systems/dsa5/templates/actors/actor-notes.html}}
                </div>
            {{/when}}
        </section>
    </section>
</form>
